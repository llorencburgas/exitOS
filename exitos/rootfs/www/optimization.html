<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Control energètic eXIT</title>
    <link rel="stylesheet" href="resources/mainStyle.css">
    <link rel="icon" type="image/x-icon" href="static/favicon.ico">
    <!--    <link rel="stylesheet" href="../resources/mainStyle.css">-->

    <!-- llibreria d'icontes per al navbar-->
    <script src="https://cdn.plot.ly/plotly-3.1.0.min.js" charset="utf-8"></script>
    <script src="https://kit.fontawesome.com/d259d5cefc.js" crossorigin="anonymous"></script>
</head>
<body>
<!--    NAVBAR     -->
% rebase('./www/base.html', title='Exitos')

<div class="container">
    <!--    PAGE NAME AND DATE  -->
    <div class="content-section">
        <h1>Optimització</h1>
        <h4>{{current_date}}</h4>
        <button id="test-optimization" onclick="TestOptimization()"><i style="font-size: medium; margin-bottom: 5px;" class="fa-solid fa-ghost"></i> Forçar Optimització</button>
    </div>


    <div class="button-div">
        <h3>Sonnenbatterie 79259</h3>
        <span class="label-text"> OFF </span>
        <input type="checkbox" id="toggle" class="offscreen" onchange="changeVisibleSensors()"/>
        <label for="toggle" class="switch"></label>
        <span class="label-text"> ON </span>
    </div>


    <!--    PLANIFICACIÓ SONNEN  -->
    <div class="scheduler-container">
<!--        <h2>Horaris Configurats</h2>-->
        <div id="scheduler-grid" class="scheduler-grid">
            <!--AQUI ES POSEN ELS FORECASTS-->
        </div>

    </div>




</div>



</body>

<script>
      function TestOptimization() {
        fetch('optimize')
            .then(response => response.text())
            .then(data => console.log("Optimization pressed"))
    }

    function onLoadPage(){
          const parent_div_scheduler = document.getElementById("scheduler-grid");
                  fetch('get_scheduler_data')
            .then(response => response.json())
            .then(data => {
                const container = document.createElement("div");
                container.className = "scheduler-card";
                parent_div_scheduler.appendChild(container);

                Plotly.newPlot(container, data.data, data.layout)
            })
    }
    onLoadPage();
</script>
</html>